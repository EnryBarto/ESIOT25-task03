<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Tank</title>
    <script src="javascript.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
    <style>html {font-size: 97%;} </style>
</head>

<body class="container-fluid p-0 bg-light overflow-x-hidden">
    <header>
        <h1 class="text-center p-3 bg-secondary text-light font-monospace mb-3">Smart Tank Monitoring System</h1>
    </header>
    <main>
        <h2 class="text-center mb-3">DBS: Dashboard Subsystem</h2>
        <div class="row justify-content-center mb-4">
            <div class="d-grid gap-2 col-10 col-md-4">
                <button type="button" id="openModalButton" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#ipModal"><i class="bi bi-hdd-network"></i> Set HTTP Server Address</button>
            </div>
        </div>
        <div class="row justify-content-center mb-1 gx-6">
            <div class="col-10 col-xl-6 mb-5" style="height: 400px;">
                <h3 class="text-center mb-3">Rainwater level</h3>
                <canvas id="myChart"></canvas>
            </div>
            <div class="col-10 col-xl-5 mt-3 mt-xl-0 px-lg-3">
                <h3 class="text-center mb-3">Control Panel</h3>
                <ul class="list-unstyled">
                    <li><strong>Current State: </strong><span id="cusState"></span></li>
                    <li><strong>Valve opening: </strong><span id="valveLevel"></span>%</li>
                </ul>
                <div class="d-grid gap-2 col-12">
                    <button type="button" class="btn btn-danger d-none" id="switchMan" onclick="toggleMode()"><i class="bi bi-sliders"></i> Switch to MANUAL</button>
                    <div id="switchAuto" class="d-none">
                        <div class="mt-2 mb-2">
                            <label for="valveOpening" class="form-label"><strong>Set valve opening:</strong></label>
                            <input type="range" class="form-range" id="valveOpening" min="0" max="100" step="1" onchange="setValveOpening()">
                        </div>
                        <button type="button" class="btn btn-danger col-12" onclick="toggleMode()"><i class="bi bi-gear-wide-connected"></i> Switch to AUTOMATIC</button>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <footer class="bg-secondary text-white text-center text-lg-start mt-4 container-fluid flex-grow-1 font-monospace">
        <div class="text-center pt-3">
            <h1 class="fs-3">Assignment #03 - Smart Tank Monitoring System</h1>
        </div>
        <div class="text-center p-2 row" style="font-size: 0.9em">
            <p class="col-12 mb-1">Progetto per il corso di Sistemi Embedded e IoT A.A.2025/26 realizzato da:</p>
            <div class="col-12">
                <ul class="row list-unstyled justify-content-center">
                    <li class="col-12 mt-2 col-lg-4">Enrico Bartocetti:<br/><a class="text-white" href="mailto:enrico.bartocetti@studio.unibo.it">enrico.bartocetti@studio.unibo.it</a></li>
                </ul>
            </div>
            <p class="col-12">Source Code: <a href="https://github.com/EnryBarto/ESIOT25-task03" class="bg-light text-dark">GitHub</a></p>
        </div>
    </footer>

    <div class="modal fade" id="ipModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel">Insert the address of the HTTP Server</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="serverAddress" class="col-form-label">Address:</label>
                        <input type="text" class="form-control" id="serverAddress" value="localhost:8888">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" onclick="setServerAddress()" data-bs-dismiss="modal">Set</button>
                </div>
            </div>
        </div>
    </div>
</body>

</html>